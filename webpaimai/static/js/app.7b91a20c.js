(function(){"use strict";var e={3788:function(e,o,t){var s=t(3751),r=t(641);const n={id:"app"};function i(e,o,t,s,i,l){const a=(0,r.g2)("router-link"),u=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",n,[(0,r.Lk)("header",null,[o[5]||(o[5]=(0,r.Lk)("h1",null,"拍卖系统",-1)),(0,r.Lk)("nav",null,[s.isLoggedIn?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.Wv)(a,{key:0,to:"/login"},{default:(0,r.k6)((()=>o[1]||(o[1]=[(0,r.eW)("登录")]))),_:1})),s.isLoggedIn?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.Wv)(a,{key:1,to:"/register"},{default:(0,r.k6)((()=>o[2]||(o[2]=[(0,r.eW)("注册")]))),_:1})),s.isLoggedIn?((0,r.uX)(),(0,r.Wv)(a,{key:2,to:"/goods-list"},{default:(0,r.k6)((()=>o[3]||(o[3]=[(0,r.eW)("商品列表")]))),_:1})):(0,r.Q3)("",!0),(0,r.bF)(a,{to:"/user-profile",class:"user-profile-link"},{default:(0,r.k6)((()=>o[4]||(o[4]=[(0,r.eW)("个人信息")]))),_:1}),s.isLoggedIn?((0,r.uX)(),(0,r.CE)("button",{key:3,onClick:o[0]||(o[0]=(...e)=>s.logout&&s.logout(...e))},"退出登录")):(0,r.Q3)("",!0)])]),(0,r.Lk)("main",null,[(0,r.bF)(u,{onLoginSuccess:s.handleLoginSuccess},null,8,["onLoginSuccess"])]),o[6]||(o[6]=(0,r.Lk)("footer",null,[(0,r.Lk)("p",null,"© 20220441228")],-1))])}var l=t(953),a={name:"App",setup(){const e=(0,l.Kh)({isLoggedIn:!1}),o=()=>{e.isLoggedIn=!0},t=()=>{e.isLoggedIn=!1};return{isLoggedIn:e.isLoggedIn,handleLoginSuccess:o,logout:t}}},u=t(6262);const d=(0,u.A)(a,[["render",i]]);var c=d,p=(t(8992),t(7550),t(5220)),h=t(33);const m={class:"user-login"},g={class:"login-container"},k={class:"form-group"},b={class:"form-group"},f=["disabled"],_={key:0,class:"error"};function y(e,o,t,n,i,l){return(0,r.uX)(),(0,r.CE)("div",m,[(0,r.Lk)("div",g,[o[5]||(o[5]=(0,r.Lk)("h1",null,"用户登录",-1)),(0,r.Lk)("form",{onSubmit:o[2]||(o[2]=(0,s.D$)(((...e)=>l.handleLogin&&l.handleLogin(...e)),["prevent"]))},[(0,r.Lk)("div",k,[o[3]||(o[3]=(0,r.Lk)("label",{for:"username"},"用户名:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>i.username=e),type:"text",id:"username",placeholder:"输入用户名",required:""},null,512),[[s.Jo,i.username]])]),(0,r.Lk)("div",b,[o[4]||(o[4]=(0,r.Lk)("label",{for:"password"},"密码:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>i.password=e),type:"password",id:"password",placeholder:"输入密码",required:""},null,512),[[s.Jo,i.password]])]),(0,r.Lk)("button",{type:"submit",class:"login-button",disabled:i.loading},(0,h.v_)(i.loading?"登录中...":"登录"),9,f),i.errorMessage?((0,r.uX)(),(0,r.CE)("p",_,(0,h.v_)(i.errorMessage),1)):(0,r.Q3)("",!0)],32)])])}t(4114);var L={name:"UserLogin",data(){return{username:"",password:"",errorMessage:"",loading:!1}},methods:{async handleLogin(){if(this.username&&this.password){this.errorMessage="",this.loading=!0;try{const e=await fetch("http://localhost:5000/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}),o=await e.json();if(e.ok){alert("登录成功！");const e=o.user;e?(console.log("登录返回的用户数据:",e),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("isLoggedIn",!0),"超级用户"===e.role?this.$router.push("/admin-dashboard"):this.$router.push("/goods-list")):this.errorMessage="登录失败，请检查用户名或密码！"}else this.errorMessage=o.error||"登录失败，请检查用户名或密码！"}catch(e){console.error("登录出错:",e),this.errorMessage="网络错误，请稍后再试！"}finally{this.loading=!1}}else this.errorMessage="用户名和密码不能为空！"}}};const v=(0,u.A)(L,[["render",y],["__scopeId","data-v-296b3cbf"]]);var w=v;const U={class:"user-register"},E={class:"register-container"},C={class:"form-group"},G={class:"form-group"};function F(e,o,t,n,i,l){return(0,r.uX)(),(0,r.CE)("div",U,[(0,r.Lk)("div",E,[o[6]||(o[6]=(0,r.Lk)("h1",null,"用户注册",-1)),(0,r.Lk)("form",{onSubmit:o[2]||(o[2]=(0,s.D$)(((...e)=>l.handleRegister&&l.handleRegister(...e)),["prevent"]))},[(0,r.Lk)("div",C,[o[3]||(o[3]=(0,r.Lk)("label",{for:"username"},"用户名:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>i.username=e),type:"text",id:"username",placeholder:"输入用户名",required:""},null,512),[[s.Jo,i.username]])]),(0,r.Lk)("div",G,[o[4]||(o[4]=(0,r.Lk)("label",{for:"password"},"密码:",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>i.password=e),type:"password",id:"password",placeholder:"输入密码",required:""},null,512),[[s.Jo,i.password]])]),o[5]||(o[5]=(0,r.Lk)("button",{type:"submit",class:"register-button"},"注册",-1))],32)])])}var X={name:"UserRegister",data(){return{username:"",password:""}},methods:{async handleRegister(){try{const e=await fetch("http://localhost:5000/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}),o=await e.json();e.ok?(alert("注册成功！"),this.$router.push("/login")):alert(o.error||"注册失败")}catch(e){console.error("注册出错:",e)}}}};const S=(0,u.A)(X,[["render",F],["__scopeId","data-v-3d3c5b35"]]);var I=S;const J={class:"goods-list"},V={key:0},O={key:2};function A(e,o,t,s,n,i){const l=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",J,[o[1]||(o[1]=(0,r.Lk)("h1",null,"商品列表",-1)),n.user?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("p",V,"请登录以查看商品列表。")),n.goods.length>0?((0,r.uX)(),(0,r.CE)("div",{key:n.goodsKey},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(n.goods,(e=>((0,r.uX)(),(0,r.CE)("div",{class:"goods-item",key:e.id},[(0,r.Lk)("h2",null,(0,h.v_)(e.name),1),(0,r.Lk)("p",null,"商品 ID: "+(0,h.v_)(e.id),1),(0,r.Lk)("p",null,"卖家 ID: "+(0,h.v_)(e.seller_id||"无卖家信息"),1),(0,r.Lk)("p",null,"起拍价: ¥"+(0,h.v_)(e.price),1),(0,r.bF)(l,{to:`/auction-detail/${e.id}`,class:"view-auction-button"},{default:(0,r.k6)((()=>o[0]||(o[0]=[(0,r.eW)(" 查看拍卖 ")]))),_:2},1032,["to"])])))),128))])):((0,r.uX)(),(0,r.CE)("p",O,"暂无商品信息。"))])}t(3949);var j={name:"GoodsList",data(){return{user:null,goods:[],goodsKey:0}},mounted(){const e=localStorage.getItem("user");if(e){console.log("读取的用户数据:",e);try{this.user=JSON.parse(e)}catch(o){console.error("解析用户数据时出错:",o),this.user=null}}else console.log("没有找到用户数据"),this.user=null;this.user?this.fetchGoods():(console.log("用户未登录，跳转到登录页面"),this.$router.push("/login"))},methods:{async fetchGoods(){try{const e=await fetch("http://localhost:5000/all_goods"),o=await e.json();console.log("获取的商品数据:",o),e.ok?(this.goods=[],o.forEach((e=>{this.goods.push(e)})),console.log("商品数据已成功加载:",this.goods),this.goodsKey++):console.error(o.error||"无法加载商品信息")}catch(e){console.error("获取商品列表失败:",e),console.error("详细错误信息:",e.message)}}}};const Q=(0,u.A)(j,[["render",A],["__scopeId","data-v-7f15edd8"]]);var q=Q;const T={class:"admin-dashboard"},$={key:1},D=["onClick"],M=["onClick"],P={key:1},N=["onClick"],W=["onClick"],x={key:0,class:"modal"},K={class:"modal-content"},R={key:1,class:"modal"},B={class:"modal-content"};function z(e,o,t,n,i,l){return(0,r.uX)(),(0,r.CE)("div",T,[o[30]||(o[30]=(0,r.Lk)("h1",null,"超级用户管理界面",-1)),(0,r.Lk)("section",null,[o[23]||(o[23]=(0,r.Lk)("h2",null,"用户管理",-1)),i.isUserFormVisible?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:o[0]||(o[0]=(...e)=>l.toggleUserForm&&l.toggleUserForm(...e))},"添加用户")),i.isUserFormVisible?((0,r.uX)(),(0,r.CE)("div",$,[(0,r.Lk)("form",{onSubmit:o[4]||(o[4]=(0,s.D$)(((...e)=>l.addUser&&l.addUser(...e)),["prevent"]))},[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>i.newUser.username=e),placeholder:"用户名",required:""},null,512),[[s.Jo,i.newUser.username]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>i.newUser.password=e),type:"password",placeholder:"密码",required:""},null,512),[[s.Jo,i.newUser.password]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>i.newUser.role=e),placeholder:"角色",required:""},null,512),[[s.Jo,i.newUser.role]]),o[22]||(o[22]=(0,r.Lk)("button",{type:"submit"},"添加",-1))],32),(0,r.Lk)("button",{onClick:o[5]||(o[5]=(...e)=>l.toggleUserForm&&l.toggleUserForm(...e))},"取消")])):(0,r.Q3)("",!0),(0,r.Lk)("ul",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.users,(e=>((0,r.uX)(),(0,r.CE)("li",{key:e.user_id},[(0,r.Lk)("p",null,(0,h.v_)(e.username)+" ("+(0,h.v_)(e.role)+")",1),(0,r.Lk)("button",{onClick:o=>l.editUser(e)},"编辑",8,D),(0,r.Lk)("button",{onClick:o=>l.deleteUser(e.user_id)},"删除",8,M)])))),128))])]),(0,r.Lk)("section",null,[o[25]||(o[25]=(0,r.Lk)("h2",null,"商品管理",-1)),i.isGoodsFormVisible?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:o[6]||(o[6]=(...e)=>l.toggleGoodsForm&&l.toggleGoodsForm(...e))},"添加商品")),i.isGoodsFormVisible?((0,r.uX)(),(0,r.CE)("div",P,[(0,r.Lk)("form",{onSubmit:o[10]||(o[10]=(0,s.D$)(((...e)=>l.addGoods&&l.addGoods(...e)),["prevent"]))},[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[7]||(o[7]=e=>i.newGoods.name=e),placeholder:"商品名称",required:""},null,512),[[s.Jo,i.newGoods.name]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[8]||(o[8]=e=>i.newGoods.price=e),type:"number",placeholder:"价格",required:""},null,512),[[s.Jo,i.newGoods.price]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[9]||(o[9]=e=>i.newGoods.seller_id=e),placeholder:"卖家ID",required:""},null,512),[[s.Jo,i.newGoods.seller_id]]),o[24]||(o[24]=(0,r.Lk)("button",{type:"submit"},"添加",-1))],32),(0,r.Lk)("button",{onClick:o[11]||(o[11]=(...e)=>l.toggleGoodsForm&&l.toggleGoodsForm(...e))},"取消")])):(0,r.Q3)("",!0),(0,r.Lk)("ul",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.goods,(e=>((0,r.uX)(),(0,r.CE)("li",{key:e.id},[(0,r.Lk)("p",null,(0,h.v_)(e.name)+" - ¥"+(0,h.v_)(e.price),1),(0,r.Lk)("button",{onClick:o=>l.editGoods(e)},"编辑",8,N),(0,r.Lk)("button",{onClick:o=>l.deleteGoods(e.id)},"删除",8,W)])))),128))])]),i.showUserEditModal?((0,r.uX)(),(0,r.CE)("div",x,[(0,r.Lk)("div",K,[o[27]||(o[27]=(0,r.Lk)("h3",null,"编辑用户",-1)),(0,r.Lk)("form",{onSubmit:o[16]||(o[16]=(0,s.D$)(((...e)=>l.submitUserEdit&&l.submitUserEdit(...e)),["prevent"]))},[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[12]||(o[12]=e=>i.editUserForm.username=e),placeholder:"用户名",required:""},null,512),[[s.Jo,i.editUserForm.username]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[13]||(o[13]=e=>i.editUserForm.password=e),type:"password",placeholder:"密码",required:""},null,512),[[s.Jo,i.editUserForm.password]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[14]||(o[14]=e=>i.editUserForm.role=e),placeholder:"角色",required:""},null,512),[[s.Jo,i.editUserForm.role]]),o[26]||(o[26]=(0,r.Lk)("button",{type:"submit"},"保存",-1)),(0,r.Lk)("button",{onClick:o[15]||(o[15]=e=>i.showUserEditModal=!1)},"取消")],32)])])):(0,r.Q3)("",!0),i.showGoodsEditModal?((0,r.uX)(),(0,r.CE)("div",R,[(0,r.Lk)("div",B,[o[29]||(o[29]=(0,r.Lk)("h3",null,"编辑商品",-1)),(0,r.Lk)("form",{onSubmit:o[21]||(o[21]=(0,s.D$)(((...e)=>l.submitGoodsEdit&&l.submitGoodsEdit(...e)),["prevent"]))},[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[17]||(o[17]=e=>i.editGoodsForm.name=e),placeholder:"商品名称",required:""},null,512),[[s.Jo,i.editGoodsForm.name]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[18]||(o[18]=e=>i.editGoodsForm.price=e),type:"number",placeholder:"价格",required:""},null,512),[[s.Jo,i.editGoodsForm.price]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[19]||(o[19]=e=>i.editGoodsForm.seller_id=e),placeholder:"卖家ID",required:""},null,512),[[s.Jo,i.editGoodsForm.seller_id]]),o[28]||(o[28]=(0,r.Lk)("button",{type:"submit"},"保存",-1)),(0,r.Lk)("button",{onClick:o[20]||(o[20]=e=>i.showGoodsEditModal=!1)},"取消")],32)])])):(0,r.Q3)("",!0)])}var H=t(4335),Y={name:"AdminDashboard",data(){return{users:[],goods:[],newUser:{username:"",password:"",role:""},newGoods:{name:"",price:0,seller_id:""},isUserFormVisible:!1,isGoodsFormVisible:!1,editUserForm:{username:"",password:"",role:""},editGoodsForm:{name:"",price:0,seller_id:""},showUserEditModal:!1,showGoodsEditModal:!1}},mounted(){this.fetchUsers(),this.fetchGoods()},methods:{async fetchUsers(){try{const e=await fetch("http://localhost:5000/users"),o=await e.json();e.ok?this.users=o:console.error("无法加载用户信息")}catch(e){console.error("获取用户失败:",e)}},async fetchGoods(){try{const e=await fetch("http://localhost:5000/all_goods"),o=await e.json();console.log(o),e.ok?this.goods=o:console.error("无法加载商品信息")}catch(e){console.error("获取商品失败:",e)}},toggleUserForm(){this.isUserFormVisible=!this.isUserFormVisible},toggleGoodsForm(){this.isGoodsFormVisible=!this.isGoodsFormVisible},async addUser(){try{const e=await fetch("http://localhost:5000/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.newUser)}),o=await e.json();e.ok?(this.fetchUsers(),this.newUser={username:"",password:"",role:""}):console.error(o.error||"添加用户失败")}catch(e){console.error("添加用户失败:",e)}},async addGoods(){try{if(!this.newGoods.name||this.newGoods.price<=0||!this.newGoods.seller_id)return void console.error("商品名称、价格和卖家ID不能为空");console.log(this.newGoods);const e=await fetch("http://localhost:5000/goods",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({goods_name:this.newGoods.name,price:this.newGoods.price,seller_id:this.newGoods.seller_id})}),o=await e.json();e.ok?(this.fetchGoods(),this.newGoods={name:"",price:0,seller_id:""}):console.error(o.error||"添加商品失败")}catch(e){console.error("添加商品失败:",e)}},editUser(e){console.log("编辑用户",e),this.editUserForm={...e},this.showUserEditModal=!0},async submitUserEdit(){try{const e=await H.A.put(`http://localhost:5000/user/${this.editUserForm.user_id}`,this.editUserForm);console.log("用户编辑成功",e.data),this.showUserEditModal=!1,this.fetchUsers()}catch(e){console.error("用户编辑失败",e.response.data)}},editGoods(e){console.log("编辑商品",e),this.editGoodsForm={...e},this.showGoodsEditModal=!0},async submitGoodsEdit(){if(this.editGoodsForm.id)try{const e=await H.A.put(`http://localhost:5000/goods/${this.editGoodsForm.id}`,this.editGoodsForm);console.log("商品编辑成功",e.data),this.showGoodsEditModal=!1,this.fetchGoods()}catch(e){console.error("商品编辑失败",e.response?e.response.data:e.message)}else console.error("商品ID不能为空")},async deleteUser(e){try{const o=await fetch(`http://localhost:5000/users/${e}`,{method:"DELETE"});o.ok?this.fetchUsers():console.error("删除用户失败")}catch(o){console.error("删除用户失败:",o)}},async deleteGoods(e){try{const o=await fetch(`http://localhost:5000/goods/${e}`,{method:"DELETE"});o.ok?this.fetchGoods():console.error("删除商品失败")}catch(o){console.error("删除商品失败:",o)}}}};const Z=(0,u.A)(Y,[["render",z],["__scopeId","data-v-446ce1ee"]]);var ee=Z;const oe={class:"auction-detail"},te={key:0},se={key:1},re={key:2},ne={key:3},ie={key:4},le={key:5},ae={key:6},ue={key:7},de={key:8},ce={key:9},pe={key:10};function he(e,o,t,n,i,l){return(0,r.uX)(),(0,r.CE)("div",oe,[o[2]||(o[2]=(0,r.Lk)("h1",null,"拍卖详情",-1)),i.auction?((0,r.uX)(),(0,r.CE)("p",te,"商品名称: "+(0,h.v_)(i.auction.goods_name),1)):(0,r.Q3)("",!0),i.auction?((0,r.uX)(),(0,r.CE)("p",se,"商品描述: "+(0,h.v_)(i.auction.goods_description),1)):(0,r.Q3)("",!0),i.auction?((0,r.uX)(),(0,r.CE)("p",re,"当前价格: ¥"+(0,h.v_)(i.auction.current_price),1)):(0,r.Q3)("",!0),i.auction?((0,r.uX)(),(0,r.CE)("p",ne,"最低加价幅度: ¥"+(0,h.v_)(i.auction.minimum_increment),1)):(0,r.Q3)("",!0),i.auction?((0,r.uX)(),(0,r.CE)("p",ie,"起拍价: ¥"+(0,h.v_)(i.auction.starting_price),1)):(0,r.Q3)("",!0),i.auction?((0,r.uX)(),(0,r.CE)("p",le,"保留价: ¥"+(0,h.v_)(i.auction.reserve_price||"无"),1)):(0,r.Q3)("",!0),i.auction?((0,r.uX)(),(0,r.CE)("p",ae,"拍卖时长: "+(0,h.v_)(i.auction.time_long)+" 分钟",1)):(0,r.Q3)("",!0),i.auction?((0,r.uX)(),(0,r.CE)("p",ue,"拍卖开始时间: "+(0,h.v_)(i.auction.start_time),1)):(0,r.Q3)("",!0),i.auction?((0,r.uX)(),(0,r.CE)("p",de,"拍卖结束时间: "+(0,h.v_)(i.auction.end_time),1)):(0,r.Q3)("",!0),i.user?((0,r.uX)(),(0,r.CE)("div",ce,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>i.bidAmount=e),type:"number",placeholder:"请输入您的出价"},null,512),[[s.Jo,i.bidAmount]]),(0,r.Lk)("button",{onClick:o[1]||(o[1]=(...e)=>l.placeBid&&l.placeBid(...e))},"出价")])):((0,r.uX)(),(0,r.CE)("p",pe,"请登录后参与竞拍。"))])}var me={name:"AuctionDetail",data(){return{auction:null,bidAmount:0,user:null}},async mounted(){const e=this.$route.params.id;this.fetchAuctionDetail(e);const o=localStorage.getItem("user");o?this.user=JSON.parse(o):(console.log("未登录，跳转至登录页面"),this.$router.push("/login"))},methods:{async fetchAuctionDetail(e){try{const o=await fetch(`http://localhost:5000/auction/${e}`);o.ok?this.auction=await o.json():console.error("无法加载拍卖信息")}catch(o){console.error("无法加载拍卖信息:",o)}},async placeBid(){if(!this.auction)return void alert("拍卖详情尚未加载，请稍后再试！");if(this.bidAmount<=this.auction.current_price)return void alert("您的出价必须高于当前价格！");const e={bid_amount:this.bidAmount,auction_id:this.auction.auction_id};try{const o=await fetch("http://localhost:5000/bid",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(o.ok)alert("出价成功！"),this.fetchAuctionDetail(this.auction.auction_id);else{const e=await o.json();alert(`出价失败：${e.error||"请稍后重试。"}`)}}catch(o){console.error("出价失败:",o),alert("出价失败，请检查网络连接！")}}}};const ge=(0,u.A)(me,[["render",he],["__scopeId","data-v-a091732c"]]);var ke=ge;const be={class:"auction-result"},fe={key:0},_e={key:1},ye={key:2};function Le(e,o,t,s,n,i){return(0,r.uX)(),(0,r.CE)("div",be,[o[0]||(o[0]=(0,r.Lk)("h1",null,"拍卖结果",-1)),n.result.message?((0,r.uX)(),(0,r.CE)("p",fe,(0,h.v_)(n.result.message),1)):(0,r.Q3)("",!0),n.result.winner?((0,r.uX)(),(0,r.CE)("p",_e,"中标者: "+(0,h.v_)(n.result.winner),1)):(0,r.Q3)("",!0),n.result.winning_bid?((0,r.uX)(),(0,r.CE)("p",ye,"中标价: "+(0,h.v_)(n.result.winning_bid),1)):(0,r.Q3)("",!0)])}var ve={name:"AuctionResult",data(){return{result:{}}},async created(){const e=this.$route.params.id;try{const o=await fetch(`http://localhost:5000/auction/${e}/close`,{method:"POST"});this.result=await o.json()}catch(o){console.error("获取拍卖结果失败:",o)}}};const we=(0,u.A)(ve,[["render",Le],["__scopeId","data-v-22884fe2"]]);var Ue=we;const Ee={class:"create-auction"},Ce={class:"user-profile"},Ge={key:0},Fe={key:1},Xe={class:"user-info"};function Se(e,o,t,n,i,l){return(0,r.uX)(),(0,r.CE)("div",Ee,[o[18]||(o[18]=(0,r.Lk)("h2",null,"创建拍卖",-1)),(0,r.Lk)("form",{onSubmit:o[6]||(o[6]=(0,s.D$)(((...e)=>l.submitAuction&&l.submitAuction(...e)),["prevent"]))},[(0,r.Lk)("div",null,[o[7]||(o[7]=(0,r.Lk)("label",{for:"starting_price"},"起拍价",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>i.auction.starting_price=e),type:"number",id:"starting_price",required:""},null,512),[[s.Jo,i.auction.starting_price]])]),(0,r.Lk)("div",null,[o[8]||(o[8]=(0,r.Lk)("label",{for:"minimum_increment"},"最低增幅",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>i.auction.minimum_increment=e),type:"number",id:"minimum_increment",required:""},null,512),[[s.Jo,i.auction.minimum_increment]])]),(0,r.Lk)("div",null,[o[9]||(o[9]=(0,r.Lk)("label",{for:"reserve_price"},"保留价",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>i.auction.reserve_price=e),type:"number",id:"reserve_price"},null,512),[[s.Jo,i.auction.reserve_price]])]),(0,r.Lk)("div",null,[o[10]||(o[10]=(0,r.Lk)("label",{for:"start_time"},"开始时间",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>i.auction.start_time=e),type:"datetime-local",id:"start_time",required:""},null,512),[[s.Jo,i.auction.start_time]])]),(0,r.Lk)("div",null,[o[11]||(o[11]=(0,r.Lk)("label",{for:"time_long"},"拍卖时长（分钟）",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[4]||(o[4]=e=>i.auction.time_long=e),type:"number",id:"time_long",required:""},null,512),[[s.Jo,i.auction.time_long]])]),(0,r.Lk)("div",null,[o[12]||(o[12]=(0,r.Lk)("label",{for:"goods_name"},"商品名字",-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":o[5]||(o[5]=e=>i.auction.goods_name=e),type:"text",id:"goods_name",required:""},null,512),[[s.Jo,i.auction.goods_name]])]),o[13]||(o[13]=(0,r.Lk)("button",{type:"submit"},"创建拍卖",-1))],32),(0,r.Lk)("div",Ce,[o[17]||(o[17]=(0,r.Lk)("h1",null,"个人信息",-1)),i.user?((0,r.uX)(),(0,r.CE)("div",Fe,[(0,r.Lk)("div",Xe,[o[16]||(o[16]=(0,r.Lk)("h2",null,"当前信息：",-1)),(0,r.Lk)("p",null,[o[14]||(o[14]=(0,r.Lk)("strong",null,"用户名：",-1)),(0,r.eW)(" "+(0,h.v_)(i.user.username),1)]),(0,r.Lk)("p",null,[o[15]||(o[15]=(0,r.Lk)("strong",null,"角色：",-1)),(0,r.eW)(" "+(0,h.v_)(i.user.role),1)])])])):((0,r.uX)(),(0,r.CE)("p",Ge,"请登录以查看个人信息。"))])])}var Ie={data(){return{auction:{starting_price:"",minimum_increment:"",reserve_price:"",start_time:"",time_long:"",goods_name:"",user_id:""},user:null}},created(){const e=JSON.parse(localStorage.getItem("user"));e&&e.user_id?(this.auction.user_id=e.user_id,this.user=e):console.error("未登录用户，无法获取用户ID")},methods:{async submitAuction(){try{const e=this.auction.start_time.replace("T"," "),o=await fetch("http://localhost:5000/goods",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({goods_name:this.auction.goods_name,price:this.auction.starting_price,seller_id:this.auction.user_id})}),t=await o.json();if(o.ok){console.log("商品创建成功:",t);const o=await fetch("http://localhost:5000/auction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({starting_price:this.auction.starting_price,minimum_increment:this.auction.minimum_increment,reserve_price:this.auction.reserve_price,start_time:e,time_long:this.auction.time_long,goods_id:t.goods_id,user_id:this.auction.user_id})}),s=await o.json();o.ok?console.log("拍卖创建成功:",s):console.error("拍卖创建失败:",s.error)}else console.error("商品创建失败:",t.error)}catch(e){console.error("请求出错:",e)}}}};const Je=(0,u.A)(Ie,[["render",Se],["__scopeId","data-v-736e7b8f"]]);var Ve=Je;const Oe=[{path:"/",redirect:"/login"},{path:"/login",component:w},{path:"/register",component:I},{path:"/goods-list",component:q},{path:"/admin-dashboard",component:ee},{path:"/auction-detail/:id",component:ke,props:!0},{path:"/auction-result/:id",component:Ue,props:!0},{path:"/user-profile",component:Ve,meta:{requiresAuth:!0}}],Ae=(0,p.aE)({history:(0,p.LA)(),routes:Oe});Ae.beforeEach(((e,o,t)=>{const s="true"===localStorage.getItem("isLoggedIn");e.matched.some((e=>e.meta.requiresAuth))?s?t():t({path:"/login"}):t()}));var je=Ae;const Qe=(0,s.Ef)(c);je.beforeEach(((e,o,t)=>{const s=localStorage.getItem("isLoggedIn");"/goods-list"!==e.path||s?t():t("/login")})),Qe.use(je),Qe.mount("#app")}},o={};function t(s){var r=o[s];if(void 0!==r)return r.exports;var n=o[s]={exports:{}};return e[s].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(o,s,r,n){if(!s){var i=1/0;for(d=0;d<e.length;d++){s=e[d][0],r=e[d][1],n=e[d][2];for(var l=!0,a=0;a<s.length;a++)(!1&n||i>=n)&&Object.keys(t.O).every((function(e){return t.O[e](s[a])}))?s.splice(a--,1):(l=!1,n<i&&(i=n));if(l){e.splice(d--,1);var u=r();void 0!==u&&(o=u)}}return o}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,r,n]}}(),function(){t.d=function(e,o){for(var s in o)t.o(o,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:o[s]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(o){return 0===e[o]};var o=function(o,s){var r,n,i=s[0],l=s[1],a=s[2],u=0;if(i.some((function(o){return 0!==e[o]}))){for(r in l)t.o(l,r)&&(t.m[r]=l[r]);if(a)var d=a(t)}for(o&&o(s);u<i.length;u++)n=i[u],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(d)},s=self["webpackChunkauction_system"]=self["webpackChunkauction_system"]||[];s.forEach(o.bind(null,0)),s.push=o.bind(null,s.push.bind(s))}();var s=t.O(void 0,[504],(function(){return t(3788)}));s=t.O(s)})();
//# sourceMappingURL=app.7b91a20c.js.map